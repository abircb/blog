<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.9.0">
    <!-- hexo-inject:begin --><!-- hexo-inject:end --><!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="description" content="These past two weeks I have been interning at Infibeam- a company that manages all of India’s public procurement using their online Government eMarketplace (GeM) platform- as a Business Intelligence i">
<meta name="keywords" content="JavaScript,Libraries,Node.js">
<meta property="og:type" content="article">
<meta property="og:title" content="A Node.js application to parse YAML files">
<meta property="og:url" content="https://abirbhushan.com/blog/2019/07/17/A-NodeJS-application-to-parse-YAML-files/index.html">
<meta property="og:site_name" content="DevTales">
<meta property="og:description" content="These past two weeks I have been interning at Infibeam- a company that manages all of India’s public procurement using their online Government eMarketplace (GeM) platform- as a Business Intelligence i">
<meta property="og:locale" content="default">
<meta property="og:updated_time" content="2019-07-18T12:18:21.766Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="A Node.js application to parse YAML files">
<meta name="twitter:description" content="These past two weeks I have been interning at Infibeam- a company that manages all of India’s public procurement using their online Government eMarketplace (GeM) platform- as a Business Intelligence i">
    
    
        
          
              <link rel="shortcut icon" href="/blog/images/favicon1.ico">
          
        
        
          
            <link rel="icon" type="image/png" href="/blog/images/favicon1.ico" sizes="192x192">
          
        
        
          
            <link rel="apple-touch-icon" sizes="180x180" href="/blog/images/favicon1.ico">
          
        
    
    <!-- title -->
    <title>A Node.js application to parse YAML files</title>
    <!-- styles -->
    <link rel="stylesheet" href="/blog/css/style.css">
    <!-- persian styles -->
    
      <link rel="stylesheet" href="/blog/css/rtl.css">
    
    <!-- rss --><!-- hexo-inject:begin --><!-- hexo-inject:end -->
    
    
</head>

<body class="max-width mx-auto px3 ltr">
    
      <!-- hexo-inject:begin --><!-- hexo-inject:end --><div id="header-post">
  <a id="menu-icon" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fas fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
         
          <li><a href="/blog/">Home</a></li>
         
          <li><a href="https://abirbhushan.com/">About</a></li>
         
          <li><a href="/blog/archives/">Archive</a></li>
        
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" href="/blog/2019/07/23/DataTables-API/"><i class="fas fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" href="/blog/2019/07/13/A-cool-Poker-trick-The-Math-behind-Pot-Odds/"><i class="fas fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" href="#"><i class="fas fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=https://abirbhushan.com/blog/2019/07/17/A-NodeJS-application-to-parse-YAML-files/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=https://abirbhushan.com/blog/2019/07/17/A-NodeJS-application-to-parse-YAML-files/&text=A Node.js application to parse YAML files"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https://abirbhushan.com/blog/2019/07/17/A-NodeJS-application-to-parse-YAML-files/&title=A Node.js application to parse YAML files"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https://abirbhushan.com/blog/2019/07/17/A-NodeJS-application-to-parse-YAML-files/&is_video=false&description=A Node.js application to parse YAML files"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=A Node.js application to parse YAML files&body=Check out this article: https://abirbhushan.com/blog/2019/07/17/A-NodeJS-application-to-parse-YAML-files/"><i class="fas fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=https://abirbhushan.com/blog/2019/07/17/A-NodeJS-application-to-parse-YAML-files/&title=A Node.js application to parse YAML files"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=https://abirbhushan.com/blog/2019/07/17/A-NodeJS-application-to-parse-YAML-files/&title=A Node.js application to parse YAML files"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=https://abirbhushan.com/blog/2019/07/17/A-NodeJS-application-to-parse-YAML-files/&title=A Node.js application to parse YAML files"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=https://abirbhushan.com/blog/2019/07/17/A-NodeJS-application-to-parse-YAML-files/&title=A Node.js application to parse YAML files"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=https://abirbhushan.com/blog/2019/07/17/A-NodeJS-application-to-parse-YAML-files/&name=A Node.js application to parse YAML files&description="><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
</ul>

    </div>
    <div id="toc">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#JS-YAML-YAML-1-2-parser"><span class="toc-number">1.</span> <span class="toc-text">JS-YAML - YAML 1.2 parser</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Parsing-Custom-YAML-tags"><span class="toc-number">2.</span> <span class="toc-text">Parsing Custom YAML tags</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Summary"><span class="toc-number">3.</span> <span class="toc-text">Summary</span></a></li></ol>
    </div>
  </span>
</div>

    
    <div class="content index py4">
        
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle" itemprop="name headline">
        A Node.js application to parse YAML files
    </h1>



    <div class="meta">
      <span class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span itemprop="name">DevTales</span>
      </span>
      
    <div class="postdate">
      
        <time datetime="2019-07-17T15:29:55.000Z" itemprop="datePublished">2019-07-17</time>
        
      
    </div>


      

      
    <div class="article-tag">
        <i class="fas fa-tag"></i>
        <a class="tag-link" href="/blog/tags/JavaScript/">JavaScript</a>, <a class="tag-link" href="/blog/tags/Libraries/">Libraries</a>, <a class="tag-link" href="/blog/tags/Node-js/">Node.js</a>
    </div>


    </div>
  </header>
  

  <div class="content" itemprop="articleBody">
    <p>These past two weeks I have been interning at Infibeam- a company that manages all of India’s public procurement using their online Government eMarketplace (GeM) platform- as a Business Intelligence intern. The company’s Data Warehouse in Bangalore sends all its data in YAML files, but the Analytics team needs this data in a database. So I was given the job of automating this process of putting the YAML data in an SQL database. To do so, I am building a Node.js service that first converts YAML to JSON and then inserts it into a DB.</p>
<p>Here, I will be discussing my use of JS-YAML to accomplish this task.</p>
<h2 id="JS-YAML-YAML-1-2-parser"><a href="#JS-YAML-YAML-1-2-parser" class="headerlink" title="JS-YAML - YAML 1.2 parser"></a>JS-YAML - YAML 1.2 parser</h2><p><a href="https://github.com/nodeca/js-yaml" target="_blank" rel="noopener">js-yaml</a> is the most popular library to convert YAML files to JSON.</p>
<p>To install or use js-yml, first install <a href="https://nodejs.org/en/" target="_blank" rel="noopener">Node.js</a>, then</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install js-yml</span><br></pre></td></tr></table></figure>

<p>Getting started is very easy</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">yaml = <span class="built_in">require</span>(<span class="string">'js-yaml'</span>);</span><br><span class="line">fs   = <span class="built_in">require</span>(<span class="string">'fs'</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Get document, or throw exception on error</span></span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">  <span class="keyword">var</span> yamlData = yaml.safeLoad(fs.readFileSync(<span class="string">'foo/bar'</span>, <span class="string">'utf8'</span>));</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="built_in">JSON</span>.stringify(yamlData));</span><br><span class="line">&#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(error);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>The code above reads your YAML file and then prints it out in JSON. This alone is enough to parse any simple YAML file. But what if my YAML has custom tags in it? Life will get just a little bit tough then as we will have to create a Schema to parse the YAML. There is not a lot of literature on this online, which is why I wanted to share this with y’all. So here is a simple fix for this.</p>
<h2 id="Parsing-Custom-YAML-tags"><a href="#Parsing-Custom-YAML-tags" class="headerlink" title="Parsing Custom YAML tags"></a>Parsing Custom YAML tags</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> json_data = &#123;</span><br><span class="line">  parseData: <span class="literal">null</span>,</span><br><span class="line">  error: <span class="literal">null</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">  <span class="keyword">let</span> CustomType = <span class="keyword">new</span> yaml.Type(<span class="string">'customTypeName'</span>, &#123;</span><br><span class="line">    kind: <span class="string">'mapping'</span></span><br><span class="line">    <span class="comment">// Other available kinds are 'scalar' (string) and 'mapping' (object).</span></span><br><span class="line">    <span class="comment">// https://yaml.org/spec/1.2/spec.html (goto 3.2.1.1. Nodes)</span></span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="keyword">let</span> CUSTOM_SCHEMA = yaml.Schema.create([CustomType]);</span><br><span class="line">  <span class="keyword">let</span> parsed_yaml_data = yaml.safeLoad(fs.readFileSync(<span class="string">'foo/bar'</span>, <span class="string">'utf8'</span>), &#123;</span><br><span class="line">    schema: CUSTOM_SCHEMA</span><br><span class="line">  &#125;);</span><br><span class="line">  json_data.parsed_data = <span class="built_in">JSON</span>.stringify(parsed_yaml_data);</span><br><span class="line">&#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">  json_data.error = e;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>What this does is create a schema for your <code>CustomType</code> and then passes that schema on to the <code>safeLoad</code> function so that when the file is being parsed, the <code>customTypeName</code> is parsed as a custom YAML tag. This will fix most <code>unknown tag</code> errors that you might be getting when parsing YAML files.</p>
<h2 id="Summary"><a href="#Summary" class="headerlink" title="Summary"></a>Summary</h2><p>So this was it- a simple fix to a very annoying problem you might come across when parsing YAML files. The YAML data I am working with is enormous, and I have created almost 12792626 schemas to parse it. It is apparently extremely confidential as well; the company gave me a 17-page non-disclosure document to sign before I got any access to the database. Also, I haven’t forgotten about the Big-O post- it’s coming, I just haven’t had time to finish it.</p>

  </div>
</article>



        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/blog/">Home</a></li>
         
          <li><a href="https://abirbhushan.com/">About</a></li>
         
          <li><a href="/blog/archives/">Archive</a></li>
        
      </ul>
    </div>

    <div id="toc-footer" style="display: none">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#JS-YAML-YAML-1-2-parser"><span class="toc-number">1.</span> <span class="toc-text">JS-YAML - YAML 1.2 parser</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Parsing-Custom-YAML-tags"><span class="toc-number">2.</span> <span class="toc-text">Parsing Custom YAML tags</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Summary"><span class="toc-number">3.</span> <span class="toc-text">Summary</span></a></li></ol>
    </div>

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=https://abirbhushan.com/blog/2019/07/17/A-NodeJS-application-to-parse-YAML-files/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=https://abirbhushan.com/blog/2019/07/17/A-NodeJS-application-to-parse-YAML-files/&text=A Node.js application to parse YAML files"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https://abirbhushan.com/blog/2019/07/17/A-NodeJS-application-to-parse-YAML-files/&title=A Node.js application to parse YAML files"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https://abirbhushan.com/blog/2019/07/17/A-NodeJS-application-to-parse-YAML-files/&is_video=false&description=A Node.js application to parse YAML files"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=A Node.js application to parse YAML files&body=Check out this article: https://abirbhushan.com/blog/2019/07/17/A-NodeJS-application-to-parse-YAML-files/"><i class="fas fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=https://abirbhushan.com/blog/2019/07/17/A-NodeJS-application-to-parse-YAML-files/&title=A Node.js application to parse YAML files"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=https://abirbhushan.com/blog/2019/07/17/A-NodeJS-application-to-parse-YAML-files/&title=A Node.js application to parse YAML files"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=https://abirbhushan.com/blog/2019/07/17/A-NodeJS-application-to-parse-YAML-files/&title=A Node.js application to parse YAML files"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=https://abirbhushan.com/blog/2019/07/17/A-NodeJS-application-to-parse-YAML-files/&title=A Node.js application to parse YAML files"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=https://abirbhushan.com/blog/2019/07/17/A-NodeJS-application-to-parse-YAML-files/&name=A Node.js application to parse YAML files&description="><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fas fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fas fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fas fa-share-alt fa-lg" aria-hidden="true"></i> Share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
  <div class="footer-left">
    Copyright &copy; 2020 Abir
  </div>
  <div class="footer-right">
    <nav>
      <ul>
         
          <li><a href="/blog/">Home</a></li>
         
          <li><a href="https://abirbhushan.com/">About</a></li>
         
          <li><a href="/blog/archives/">Archive</a></li>
        
      </ul>
    </nav>
  </div>
</footer>

    </div>
    <!-- styles -->
<link rel="stylesheet" href="/blog/lib/font-awesome/css/all.min.css">
<link rel="stylesheet" href="/blog/lib/justified-gallery/css/justifiedGallery.min.css">

    <!-- jquery -->
<script src="/blog/lib/jquery/jquery.min.js"></script>
<script src="/blog/lib/justified-gallery/js/jquery.justifiedGallery.min.js"></script>
<script src="/blog/js/main.js"></script>
<!-- search -->

<!-- Google Analytics -->

    <script type="text/javascript">
        (function(i,s,o,g,r,a,m) {i['GoogleAnalyticsObject']=r;i[r]=i[r]||function() {
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
        ga('create', 'UA-144516567-1', 'auto');
        ga('send', 'pageview');
    </script>

<!-- Baidu Analytics -->

<!-- Disqus Comments --><!-- hexo-inject:begin --><!-- hexo-inject:end -->


</body>
</html>
